version: '3.8'

# This file is automatically merged with docker-compose.yml
# Used for local development - typically not committed to version control
# To use: docker-compose up (automatically includes override file)

services:
  backend:
    build: .
    ports:
      - "8000:8000"
    environment:
      DATABASE_URL: postgresql+asyncpg://env360:env360@postgres:5432/env360
      OAUTH_CLIENT_ID: ${OAUTH_CLIENT_ID}
      OAUTH_CLIENT_SECRET: ${OAUTH_CLIENT_SECRET}
      OAUTH_DISCOVERY_URL: ${OAUTH_DISCOVERY_URL}
      OAUTH_REDIRECT_URI: ${OAUTH_REDIRECT_URI}
      OAUTH_SCOPE: ${OAUTH_SCOPE}
      JWT_SECRET_KEY: ${JWT_SECRET_KEY}
      DEBUG: ${DEBUG:-True}
    depends_on:
      postgres:
        condition: service_healthy
    volumes:
      - .:/app
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
